{% import 'partials/section.html' as section %}
{% extends "layouts/_twocol.html" %}

{% block page_title %} Store data {% endblock %}

{% block content %}

{% include 'partials/navigation_tabs.html' %}

<h1>Search results</h1> <br>

    <div class="table">
      <table class="table" width="100%">
        <thead class="table__head table__header-cell--align">
          <tr>
            <th class="table__header-cell table__header-cell--align"> tx_id </th>
            <th class="table__header-cell"> survey_id </th>
            <th class="table__header-cell"> ru_ref </th>
            <th class="table__header-cell"> user_id </th>
            <th class="table__header-cell"> submitted_at </th>
            <th class="table__header-cell"> invalid </th>
            <th class="table__header-cell" style="text-align: center;"> Reprocess <input type="checkbox" onchange="checkAll(this)" name="chk[]" /> </th>
          </tr>
        </thead>
        <tbody>
          <form id="reprocess-form" name='reprocess-form' class="form-horizontal" method='POST' action="/reprocess">
            {% if data %}
              {% for item in data.items %}
                <tr class="table__row">
                <td class="table__cell">{{ item.tx_id }}</td>
                <td class="table__cell">{{ item.survey_id }}</td>
                <td class="table__cell">{{ item.metadata.ru_ref }}</td>
                <td class="table__cell">{{ item.metadata.user_id }}</td>
                <td class="table__cell">{{ item.submitted_at }}</td>
                <td class="table__cell">{{ item.invalid }}</td>
                <td class="table__cell" style="text-align: center;">
                  <input type="checkbox" name="reprocess-tx_id" value="{{ item.tx_id }}">
                </td>
                </tr>
              {% endfor %}


              {% for page in data.iter_pages(left_edge=3, right_edge=3, left_current=3, right_current=3) %}
                {% if page %}
                  {% if page != data.page %}
                    <a href="{{ url_for('store_bp.store', page_num=page) }}">{{ page }}</a>
                  {% else %}
                    <strong>{{ page }}</strong>
                  {% endif %}
                {% else %}
                  <span class=ellipsis>â€¦</span>
                {% endif %}
              {% endfor %}
            {% endif %}
          </form>
        </tbody>
      </table>
      <br>
      <button class="btn btn-primary" form="reprocess-form" type="submit" style="float: right;">Reprocess</button>
    </div>

{% endblock content %}
